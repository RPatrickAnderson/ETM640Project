---
title: "ETM640ProjectDraft"
author: "Randolph Anderson"
date: "March 4, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction
The 532d Training Squadron (532 TRS) is a unit in the United States Air Force (USAF).  The 532 TRS
trains the nation's intercontinental ballistic missile (ICBM) operators and maintenance forces for
ICBM and air launched cruise missile (ALCM) systems.  532 TRS instructors receive professional
development (ProD) to increase their knowledge of nuclear enterprise.  Professional development
involves sending one or more instructors on a trip to a nuclear facility in the United States. 
While on their trip, instructors receive tours and briefings from onsite personnel.  One purpose
of providing professional development is to increase effectiveness of instructors.  Instructors
can help motivate students by illuminating the importance of what students are learning.  However,
instructors also perform jobs that do not involve actively teaching students.  When in these other
jobs instructors are not in the best position to integrate what they learned into their
instruction.

## Problem Definition
Some instructors do not receive professional development until most of their instructing time is
over.  As a result, they never get a chance to share what they have learned with the students.
Since the goal of ProD is, in part, to increase the effectiveness of instructors, the unit may be
able to do a better job assigning instructors to professional development trip in a way that
balances several objectives (goals).

## Objectives/Goals
The squadron has several objectives for the professional development program.  Objectives
include (listed roughly in priority order):

1. (Budget) ProD budget should fully utilize remaining travel funds after all mission required
trips are funded; ProD Budget = Total Budget - Mission Required Trips Costs.

2. (Improve Instruction) ProD should help instructors be more effective teaching.

3. (Fair development of instructor core) Each instructor is to be given the opportunity to go on at least one ProD trip
per year.

4. (Merit):  Instructors merit is considered when assigning instructors to ProD opportunities
that are tagged as being a "glory trip".  A glory trip is does something that is extra special.
The idea is to reward high performing instructors with a special trip.

## Goal Programming Model
Goal programming is an optimization techniques to solve problems with multiple objectives.  Additionally, Goal programming allows for flexibility in meeting constraints by allowing constraints to be
deviated/broken in order to balance multiple goals.  The model will determine which instructors to send on which ProD trip for each quarter (3 month period). Goal programming models can be formulated in many
different ways. For example, some models might aim to minimized the sum of deviations from the goal targets, while other models, may be set up to minimize the largest deviation (minimax model). This project will
use a version of the minimax model. A weighted percentage based minimax model is selected for the following reasons and assumptions. It is assumed that harm from deviations may increase rapidly such that it may
not be advantage to allow one goal to float to far from target. For example, if objective 3 was allowed to deviate it could create harmful perceptions of unfairness. The percentage based minimax model was
selected because harm of deviation was assumed to be more closely related to percentage deviation then nominal deviation. Weights were applied because squadron leadership has communicated that a loose
prioritization between the goals. Weights will allow the model to capture these priorities into the results.

##D ecision Variables
The model will have a decision variable for each instructor and ProD trip. For example, for each ProD trip there will be a decision do we send each instructor. The decision variables will be captured in a
decision matrix, DV[i,j].  Where, DV[i,j] indicates the decision to send the j th instructor on the i th Pro-D trip. For example, DV[1,2] indicates the decision to send instructor 2 to Pro-D trip 1. 


## Objective 
  Min: Q, Where Q is less than or equal to the weighted ratio of goal related deviations (e.g Q <= (weight)*Deviation/GoalTarget)

## Constraints

NOTE: TO BE FILLED IN LATER REFERENCE ETM 640 project Proposal for draft constraints.

## Variable Declarations
```{r}
TotalTravelBudget = 188000 #budget for all unit funded travel. This is a hard limit. 
MissionTravelCosts = 0 #(set to zero because model assumes no mission related trips accomplished prior to model being run. This could be updated if run later in the year)
ForcastedMissionTravelCosts = 125000 #current mission related travel forcasted by resource advisor (some change expected as trips are added or cancelled)
ProDTravelCosts = 0  #(set to zero because model assumes no ProD trips accomplished prior to model being run. This could be updated if run later the year)
```

## Data Input
```{r Instructor Data}
# reads in the instructor data from a csv file.
RawInstructorData <- as.matrix(read.table(file="InstructorData.csv", row.names=1,sep=","))
colnames(RawInstructorData) <- c("Instructor","DAID", "4QHrs", "Top Performer","Active/Inactive")
RawInstructorData
```

```{r Trip Data}
# reads in the instructor data from a csv file.
RawTripData <- as.matrix(read.table(file="C:/Users/rpatr/Documents/ProDTripData.csv", row.names=1,sep=","))
colnames(RawTripData) <- c("Trip Name","MeritBased", "Cost/Instr", "instrSlotsAvailable","NumberOfDays","TotalCost")
RawTripData
```
```{rSet up}
library(ompr.roi)
library(ROI.plugin.glpk)
suppressPackageStartupMessages(library(dplyr))
library(ggplot2)
library(ggrepel)
library (magrittr, quietly = TRUE)     #Used for pipes/dplyr
library (pander, quietly = TRUE)       # for nicely formated tables
library(dplyr, quietly=TRUE)           # For data structure manipulation
library(ROI, quietly=TRUE)             # R Optimization Interface package
library(ROI.plugin.glpk, quietly=TRUE) # Connection to glpk as solver
library(ompr, quietly=TRUE)            # Optimization Modeling using R
library(ompr.roi, quietly=TRUE)        # Connective tissue
library(tidyr)
```


## Goal Programming Code
```{r}

NumOfTrips <- length(RawTripData[,1])
NumOfInstructors <- length(RawInstructorData[,1])




model <- MIPModel() %>%
  
  add_variable(Q, type = "continuous", lb = 0) %>%

  add_variable (DV[i, j], i=1:NumOfTrips, j=1:NumOfInstructors, type="integer", lb=0) %>% #add decision varibales (DV)
  
  


```




